# Security Audit â€” 2026-02-28 23:46 UTC

> Auto-generated by security-check.py â€” do not hand-edit. Sensitive values redacted as [DOMAIN], [NAME], [EMAIL].

---

## 1. SOPS Encryption Coverage

**Status: ðŸŸ¡**

- ðŸŸ¡ Possible inline credential: `kubernetes/apps/default/homepage/app/ingress.yaml:      proxy_set_header X-Proxy-Secret 56915e032a849697664f1ee8567e8ffe`
- ðŸŸ¡ Possible inline credential: `kubernetes/apps/home-automation/esphome/app/ingress.yaml:      proxy_set_header X-Proxy-Secret 256bc2442db37f82cc474c85d`
- ðŸŸ¡ Possible inline credential: `kubernetes/apps/home-automation/frigate-nvr/app/ingress.yaml:      proxy_set_header X-Proxy-Secret a12644bc9bebd49f58f48`
- ðŸŸ¡ Possible inline credential: `kubernetes/apps/monitoring/kube-prometheus-stack/app/prometheus-ingress.yaml:      proxy_set_header X-Proxy-Secret 9f816`
- ðŸŸ¡ Possible inline credential: `kubernetes/apps/monitoring/kube-prometheus-stack/app/alertmanager-ingress.yaml:      proxy_set_header X-Proxy-Secret 5fe`
- ðŸŸ¡ Possible inline credential: `kubernetes/apps/monitoring/unpoller/app/helmrelease.yaml:      auth_token = "Mmih1SVbxAJMQY36zknZN-p09CRDZbtDNzS2wO22o7N`
- ðŸŸ¡ Possible inline credential: `kubernetes/apps/office/nextcloud/app/whiteboard-proxy.yaml:          value: "a68fdf7688d44d432ca8c2b5e6fc1fdbef2427dffe9`
- ðŸŸ¡ Possible inline credential: `kubernetes/apps/storage/longhorn/app/ingress.yaml:      proxy_set_header X-Proxy-Secret 56915e032a849697664f1ee8567e8ffe`
- ðŸŸ¡ Possible inline credential: `kubernetes/bootstrap/talos/clusterconfig/kubernetes-k8s-nuc14-01.yaml:    crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JS`
- ðŸŸ¡ Possible inline credential: `kubernetes/bootstrap/talos/clusterconfig/kubernetes-k8s-nuc14-01.yaml:    key: LS0tLS1CRUdJTiBFRDI1NTE5IFBSSVZBVEUgS0VZL`

---

## 2. Sensitive Data Exposure

**Status: ðŸŸ¡**

- ðŸŸ¡ Hardcoded env secret: `kubernetes/apps/office/nextcloud/app/whiteboard-proxy.yaml:29` â€” env `JWT_SECRET_KEY` = `a68fdf7688d44d432ca8c2b5e6fc1fdbef2427dffe91e4a2f38208045444`

---

## 3. Git History Secret Scan

**Status: ðŸŸ¡**

- ðŸŸ¡ Credential-like pattern in history: `-| `kubernetes/apps/ai/langfuse/app/clickhouse.yaml` | ðŸ”´ **Plaintext** `password: clickhouse123` in `
- ðŸŸ¡ Credential-like pattern in history: `-| `kubernetes/apps/ai/langfuse/app/postgresql.yaml` | ðŸ”´ **Plaintext** `POSTGRES_PASSWORD: langfuse1`
- ðŸŸ¡ Credential-like pattern in history: `+- ðŸŸ¡ Possible inline credential: `kubernetes/apps/monitoring/unpoller/app/helmrelease.yaml:      aut`
- ðŸŸ¡ Credential-like pattern in history: `+- ðŸŸ¡ Credential-like pattern in history: `-  password: clickhouse123``
- ðŸŸ¡ Credential-like pattern in history: `+- ðŸŸ¡ Credential-like pattern in history: `-  POSTGRES_PASSWORD: langfuse123``
- ðŸŸ¡ Secret-named file committed outside sops: `kubernetes/apps/ai/bytebot/app/secret.sops.tmp.yaml`
- ðŸŸ¡ Secret-named file committed outside sops: `kubernetes/apps/ai/langfuse/app/s3-credentials.yaml`
- ðŸŸ¡ Secret-named file committed outside sops: `kubernetes/apps/backup/kopia/app/secret.yaml`
- ðŸŸ¡ Secret-named file committed outside sops: `kubernetes/apps/databases/pgadmin/app/secret.sops.yaml.bak`
- ðŸŸ¡ Secret-named file committed outside sops: `kubernetes/apps/databases/pgadmin/app/secret.yaml`
- ðŸŸ¡ Secret-named file committed outside sops: `kubernetes/apps/download/icloud-docker/app-secrets/kustomization.yaml`
- ðŸŸ¡ Secret-named file committed outside sops: `kubernetes/apps/download/icloud-docker/secrets-ks.yaml`
- ðŸŸ¡ Secret-named file committed outside sops: `kubernetes/apps/monitoring/headlamp/app/token-secret.yaml`
- ðŸŸ¡ Secret-named file committed outside sops: `kubernetes/apps/monitoring/rybbit/app/secret.sops.tmp.yaml`
- ðŸŸ¡ Secret-named file committed outside sops: `kubernetes/apps/monitoring/rybbit/clickhouse/secret.yaml`
- ðŸŸ¡ Secret-named file committed outside sops: `kubernetes/flux/meta/repositories/git/github-k8s-self-ai-ops-secret-temp.yaml`
- ðŸŸ¡ Secret-named file committed outside sops: `kubernetes/flux/meta/repositories/helm/external-secrets.yaml`
- ðŸŸ¡ Secret-named file committed outside sops: `templates/config/kubernetes/apps/cert-manager/cert-manager/issuers/secret.sops.yaml.j2`
- ðŸŸ¡ Secret-named file committed outside sops: `templates/config/kubernetes/apps/flux-system/flux-operator/instance/github/webhooks/secret.sops.yaml.j2`
- ðŸŸ¡ Secret-named file committed outside sops: `templates/config/kubernetes/apps/network/external/cloudflared/secret.sops.yaml.j2`
- ðŸŸ¡ Secret-named file committed outside sops: `templates/config/kubernetes/apps/network/external/external-dns/secret.sops.yaml.j2`
- ðŸŸ¡ Secret-named file committed outside sops: `templates/config/kubernetes/flux/components/common/cluster-secrets.sops.yaml.j2`

---

## 4. CVE / Vulnerability Check

**Status: ðŸŸ¢**

ðŸŸ¢ No findings

---

## 5. Authentik Login Analysis

**Status: ðŸŸ¢**

Failed login events (7d): **0**

---

## 6. External Attack Patterns

**Status: ðŸŸ¢**

Attack pattern hits (24h): **0**

---

## 7. RBAC & Pod Security

**Status: ðŸŸ¡**

**Privileged containers (non-infra namespaces):** 5


**Root uid=0 containers (non-infra namespaces):** 6


**hostNetwork (non-infra namespaces):** `home-automation/esphome-7d56cd4d9b-l7lpb`, `home-automation/home-assistant-55f65d687b-gqphf`, `home-automation/matter-server-8db9c7954-mhlzr`, `home-automation/music-assistant-server-89cbb6d98-s44kz`, `home-automation/otbr-59c669f9c4-d7p5g`

- ðŸŸ¡ Privileged: `home-automation/frigate-86f45bb8f6-krnnl` (frigate)
- ðŸŸ¡ Privileged: `home-automation/otbr-59c669f9c4-d7p5g` (app)
- ðŸŸ¡ Privileged: `home-automation/scrypted-7d77d7649d-wspx9` (app)
- ðŸŸ¡ Privileged: `media/jellyfin-7b86c7c64f-2lm96` (jellyfin)
- ðŸŸ¡ Privileged: `media/makemkv-7dcb467b64-vbthp` (main)
- ðŸŸ¡ Root uid=0: `ai/openclaw-7df986975-xckgp` (install-openclaw)
- ðŸŸ¡ Root uid=0: `backup/icloud-docker-mu-db549c5b-v5ncv` (app)
- ðŸŸ¡ Root uid=0: `home-automation/node-red-695d77c979-5vxxx` (app)
- ðŸŸ¡ Root uid=0: `home-automation/scrypted-7d77d7649d-wspx9` (app)
- ðŸŸ¡ Root uid=0: `media/jellyfin-7b86c7c64f-2lm96` (jellyfin)
- ðŸŸ¡ Root uid=0: `media/makemkv-7dcb467b64-vbthp` (main)

---

## 8. External Exposure Inventory

**Status: ðŸŸ¢**

**External ingresses:** 22


- `ai/langfuse`: ['langfuse.[DOMAIN]']
- `ai/open-webui`: ['open-webui.[DOMAIN]']
- `default/echo-server`: ['echo-server.[DOMAIN]']
- `download/tube-archivist`: ['tube-archivist.[DOMAIN]']
- `flux-system/flux-webhook`: ['flux-webhook.[DOMAIN]']
- `home-automation/home-assistant`: ['hass.[DOMAIN]']
- `home-automation/iobroker`: ['iobroker.[DOMAIN]']
- `home-automation/music-assistant-alexa-api`: ['music-api.[DOMAIN]']
- `home-automation/music-assistant-alexa-stream`: ['music-stream.[DOMAIN]']
- `home-automation/n8n`: ['n8n.[DOMAIN]']
- `kube-system/authentik-server`: ['auth.[DOMAIN]']
- `media/jellyfin`: ['jellyfin.[DOMAIN]']
- `monitoring/uptime-kuma-authentik-outpost`: ['kuma.[DOMAIN]']
- `monitoring/uptime-kuma`: ['kuma.[DOMAIN]']
- `my-software-development/absenty`: ['absenty-dev.[DOMAIN]']
- `my-software-production/absenty`: ['absenty.[DOMAIN]']
- `my-software-production/andreamosteller`: ['pro-andreamosteller.[DOMAIN]']
- `office/nextcloud-notify-push`: ['drive.[DOMAIN]']
- `office/nextcloud-whiteboard`: ['whiteboard.[DOMAIN]']
- `office/nextcloud`: ['drive.[DOMAIN]']
- `office/paperless-ngx`: ['paperless.[DOMAIN]']
- `office/penpot`: ['penpot.[DOMAIN]']


**LoadBalancer services:** 11

---

## 9. Certificate Integrity

**Status: ðŸŸ¡**

Wildcard cert: **35 days remaining** | issuer: ? | expires: Apr  5 00:10:55 2026 GMT

TLS secrets in cluster: 10

---

## 10. Flux Security Posture

**Status: ðŸŸ¡**

- ðŸŸ¢ `sops-age` secret present in flux-system

- ðŸŸ¢ Receiver `github-receiver`: secretRef=`github-webhook-token-secret`

- ðŸŸ¢ `flux-system/flux-system`: no inline credentials

- ðŸŸ¢ `flux-system/k8s-self-ai-ops`: no inline credentials

- ðŸŸ¡ flux-operator has cluster-admin (standard but broad)

---

## 11. UniFi Network Security

**Status: ðŸŸ¢**

Devices: **11**, unadopted: **0**

WAN health: **OK**

New clients (24h): **0**, blocked: **0**

IDS/IPS events: **0**

---

## Summary

| Section | Status | Findings |
|---------|--------|----------|
| 1. SOPS Encryption Coverage | ðŸŸ¡ | 10 warning |
| 2. Sensitive Data Exposure | ðŸŸ¡ | 1 warning |
| 3. Git History Secret Scan | ðŸŸ¡ | 22 warning |
| 4. CVE / Vulnerability Check | ðŸŸ¢ | clean |
| 5. Authentik Login Analysis | ðŸŸ¢ | clean |
| 6. External Attack Patterns | ðŸŸ¢ | clean |
| 7. RBAC & Pod Security | ðŸŸ¡ | 11 warning |
| 8. External Exposure Inventory | ðŸŸ¢ | clean |
| 9. Certificate Integrity | ðŸŸ¡ | 1 warning |
| 10. Flux Security Posture | ðŸŸ¡ | 1 warning |
| 11. UniFi Network Security | ðŸŸ¢ | clean |

## Priority Actions


### ðŸŸ¡ Warning

- **SOPS Encryption Coverage**: Possible inline credential: `kubernetes/apps/default/homepage/app/ingress.yaml:      proxy_set_header X-Proxy-Secret 56915e032a849697664f1ee8567e8ffe`
- **SOPS Encryption Coverage**: Possible inline credential: `kubernetes/apps/home-automation/esphome/app/ingress.yaml:      proxy_set_header X-Proxy-Secret 256bc2442db37f82cc474c85d`
- **SOPS Encryption Coverage**: Possible inline credential: `kubernetes/apps/home-automation/frigate-nvr/app/ingress.yaml:      proxy_set_header X-Proxy-Secret a12644bc9bebd49f58f48`
- **SOPS Encryption Coverage**: Possible inline credential: `kubernetes/apps/monitoring/kube-prometheus-stack/app/prometheus-ingress.yaml:      proxy_set_header X-Proxy-Secret 9f816`
- **SOPS Encryption Coverage**: Possible inline credential: `kubernetes/apps/monitoring/kube-prometheus-stack/app/alertmanager-ingress.yaml:      proxy_set_header X-Proxy-Secret 5fe`
- **SOPS Encryption Coverage**: Possible inline credential: `kubernetes/apps/monitoring/unpoller/app/helmrelease.yaml:      auth_token = "Mmih1SVbxAJMQY36zknZN-p09CRDZbtDNzS2wO22o7N`
- **SOPS Encryption Coverage**: Possible inline credential: `kubernetes/apps/office/nextcloud/app/whiteboard-proxy.yaml:          value: "a68fdf7688d44d432ca8c2b5e6fc1fdbef2427dffe9`
- **SOPS Encryption Coverage**: Possible inline credential: `kubernetes/apps/storage/longhorn/app/ingress.yaml:      proxy_set_header X-Proxy-Secret 56915e032a849697664f1ee8567e8ffe`
- **SOPS Encryption Coverage**: Possible inline credential: `kubernetes/bootstrap/talos/clusterconfig/kubernetes-k8s-nuc14-01.yaml:    crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JS`
- **SOPS Encryption Coverage**: Possible inline credential: `kubernetes/bootstrap/talos/clusterconfig/kubernetes-k8s-nuc14-01.yaml:    key: LS0tLS1CRUdJTiBFRDI1NTE5IFBSSVZBVEUgS0VZL`
- **Sensitive Data Exposure**: Hardcoded env secret: `kubernetes/apps/office/nextcloud/app/whiteboard-proxy.yaml:29` â€” env `JWT_SECRET_KEY` = `a68fdf7688d44d432ca8c2b5e6fc1fdbef2427dffe91e4a2f38208045444`
- **Git History Secret Scan**: Credential-like pattern in history: `-| `kubernetes/apps/ai/langfuse/app/clickhouse.yaml` | ðŸ”´ **Plaintext** `password: clickhouse123` in `
- **Git History Secret Scan**: Credential-like pattern in history: `-| `kubernetes/apps/ai/langfuse/app/postgresql.yaml` | ðŸ”´ **Plaintext** `POSTGRES_PASSWORD: langfuse1`
- **Git History Secret Scan**: Credential-like pattern in history: `+- ðŸŸ¡ Possible inline credential: `kubernetes/apps/monitoring/unpoller/app/helmrelease.yaml:      aut`
- **Git History Secret Scan**: Credential-like pattern in history: `+- ðŸŸ¡ Credential-like pattern in history: `-  password: clickhouse123``
- **Git History Secret Scan**: Credential-like pattern in history: `+- ðŸŸ¡ Credential-like pattern in history: `-  POSTGRES_PASSWORD: langfuse123``
- **Git History Secret Scan**: Secret-named file committed outside sops: `kubernetes/apps/ai/bytebot/app/secret.sops.tmp.yaml`
- **Git History Secret Scan**: Secret-named file committed outside sops: `kubernetes/apps/ai/langfuse/app/s3-credentials.yaml`
- **Git History Secret Scan**: Secret-named file committed outside sops: `kubernetes/apps/backup/kopia/app/secret.yaml`
- **Git History Secret Scan**: Secret-named file committed outside sops: `kubernetes/apps/databases/pgadmin/app/secret.sops.yaml.bak`
- **Git History Secret Scan**: Secret-named file committed outside sops: `kubernetes/apps/databases/pgadmin/app/secret.yaml`
- **Git History Secret Scan**: Secret-named file committed outside sops: `kubernetes/apps/download/icloud-docker/app-secrets/kustomization.yaml`
- **Git History Secret Scan**: Secret-named file committed outside sops: `kubernetes/apps/download/icloud-docker/secrets-ks.yaml`
- **Git History Secret Scan**: Secret-named file committed outside sops: `kubernetes/apps/monitoring/headlamp/app/token-secret.yaml`
- **Git History Secret Scan**: Secret-named file committed outside sops: `kubernetes/apps/monitoring/rybbit/app/secret.sops.tmp.yaml`
- **Git History Secret Scan**: Secret-named file committed outside sops: `kubernetes/apps/monitoring/rybbit/clickhouse/secret.yaml`
- **Git History Secret Scan**: Secret-named file committed outside sops: `kubernetes/flux/meta/repositories/git/github-k8s-self-ai-ops-secret-temp.yaml`
- **Git History Secret Scan**: Secret-named file committed outside sops: `kubernetes/flux/meta/repositories/helm/external-secrets.yaml`
- **Git History Secret Scan**: Secret-named file committed outside sops: `templates/config/kubernetes/apps/cert-manager/cert-manager/issuers/secret.sops.yaml.j2`
- **Git History Secret Scan**: Secret-named file committed outside sops: `templates/config/kubernetes/apps/flux-system/flux-operator/instance/github/webhooks/secret.sops.yaml.j2`
- **Git History Secret Scan**: Secret-named file committed outside sops: `templates/config/kubernetes/apps/network/external/cloudflared/secret.sops.yaml.j2`
- **Git History Secret Scan**: Secret-named file committed outside sops: `templates/config/kubernetes/apps/network/external/external-dns/secret.sops.yaml.j2`
- **Git History Secret Scan**: Secret-named file committed outside sops: `templates/config/kubernetes/flux/components/common/cluster-secrets.sops.yaml.j2`
- **RBAC & Pod Security**: Privileged: `home-automation/frigate-86f45bb8f6-krnnl` (frigate)
- **RBAC & Pod Security**: Privileged: `home-automation/otbr-59c669f9c4-d7p5g` (app)
- **RBAC & Pod Security**: Privileged: `home-automation/scrypted-7d77d7649d-wspx9` (app)
- **RBAC & Pod Security**: Privileged: `media/jellyfin-7b86c7c64f-2lm96` (jellyfin)
- **RBAC & Pod Security**: Privileged: `media/makemkv-7dcb467b64-vbthp` (main)
- **RBAC & Pod Security**: Root uid=0: `ai/openclaw-7df986975-xckgp` (install-openclaw)
- **RBAC & Pod Security**: Root uid=0: `backup/icloud-docker-mu-db549c5b-v5ncv` (app)
- **RBAC & Pod Security**: Root uid=0: `home-automation/node-red-695d77c979-5vxxx` (app)
- **RBAC & Pod Security**: Root uid=0: `home-automation/scrypted-7d77d7649d-wspx9` (app)
- **RBAC & Pod Security**: Root uid=0: `media/jellyfin-7b86c7c64f-2lm96` (jellyfin)
- **RBAC & Pod Security**: Root uid=0: `media/makemkv-7dcb467b64-vbthp` (main)
- **Certificate Integrity**: Unexpected certificate issuer: `?`
- **Flux Security Posture**: Flux subject has cluster-admin: `flux-operator`
