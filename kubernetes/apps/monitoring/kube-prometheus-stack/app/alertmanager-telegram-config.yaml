apiVersion: monitoring.coreos.com/v1alpha1
kind: AlertmanagerConfig
metadata:
  name: telegram
  namespace: monitoring
  labels:
    alertmanager-config: telegram
spec:
  route:
    receiver: telegram
    groupBy:
      - alertname
    groupWait: 0s
    groupInterval: 1s
    repeatInterval: 1s
  receivers:
    - name: telegram
      telegramConfigs:
        - botToken:
            name: alertmanager-telegram-secret
            key: bot-token
          chatID: 671676995  # numeric chat ID (must be an integer)
          parseMode: MarkdownV2  # use Markdown V2 parsing to support `*` formatting
          sendResolved: true
          message: |
            *Alert:* {{ .CommonLabels.alertname }}
            *Severity:* {{ .CommonLabels.severity }}
            *Instance:* {{ .CommonLabels.instance }}
            *Summary:* {{ .CommonAnnotations.summary }}
